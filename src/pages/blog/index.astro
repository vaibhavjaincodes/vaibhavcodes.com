---
import { getCollection } from 'astro:content';
import '../../styles/global.css';

const posts = await getCollection('blog', ({ data }) => {
  return data.draft !== true;
});

// Sort posts by publish date (newest first)
posts.sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf());
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>Blog | Vaibhav Jain</title>
    <meta name="description" content="Technical articles on software engineering, system design, and how technology works under the hood." />
  </head>
  <body class="font-sans bg-white">
    <!-- Header -->
    <header class="bg-white/95 backdrop-blur-sm border-b border-slate-200 sticky top-0 z-50">
      <nav class="flex justify-between items-center py-5 px-6 max-w-6xl mx-auto">
        <div class="text-xl font-extrabold text-slate-900 tracking-tight">
          <a href="/" class="hover:text-indigo-600 transition-colors">Vaibhav Jain</a>
        </div>
        <ul class="flex gap-10 list-none">
          <li><a href="/blog" class="text-indigo-600 font-medium text-sm transition-colors">Blog</a></li>
          <li><a href="/courses" class="text-slate-600 font-medium text-sm hover:text-indigo-600 transition-colors">Courses</a></li>
          <li><a href="/papers" class="text-slate-600 font-medium text-sm hover:text-indigo-600 transition-colors">Papers</a></li>
          <li><a href="/books" class="text-slate-600 font-medium text-sm hover:text-indigo-600 transition-colors">Books</a></li>
        </ul>
      </nav>
    </header>

    <main class="py-16 bg-white">
      <div class="max-w-6xl mx-auto px-6">
        <header class="text-center mb-16">
          <h1 class="text-4xl md:text-5xl font-extrabold text-slate-900 mb-4 tracking-tight">Technical Articles</h1>
          <p class="text-xl text-slate-600 max-w-2xl mx-auto leading-relaxed">Deep dives into software engineering, system design, and how technology works under the hood.</p>
        </header>

        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16">
          {posts.map((post) => (
            <article class="bg-white border border-slate-200 rounded-xl p-6 hover:shadow-xl hover:border-indigo-200 hover:-translate-y-1 transition-all duration-300 relative group">
              {post.data.featured && <div class="absolute top-4 right-4 bg-indigo-600 text-white px-3 py-1 rounded-full text-xs font-semibold">Featured</div>}
              
              <div class="flex justify-between items-start mb-4 gap-4">
                <time datetime={post.data.publishDate.toISOString()} class="text-slate-500 text-sm">
                  {post.data.publishDate.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                  })}
                </time>
                {post.data.tags && (
                  <div class="flex gap-2 flex-wrap">
                    {post.data.tags.slice(0, 2).map((tag) => (
                      <span class="bg-slate-100 text-slate-600 px-2 py-1 rounded-full text-xs font-medium">{tag}</span>
                    ))}
                  </div>
                )}
              </div>

              <h2 class="mb-3">
                <a href={`/blog/${post.slug}`} class="text-slate-900 hover:text-indigo-600 transition-colors text-xl font-bold leading-tight line-clamp-2">{post.data.title}</a>
              </h2>
              
              <p class="text-slate-600 mb-4 leading-relaxed line-clamp-3">{post.data.description}</p>
              
              <a href={`/blog/${post.slug}`} class="text-indigo-600 hover:text-indigo-800 font-semibold text-sm group-hover:translate-x-1 transition-all duration-300 inline-flex items-center gap-1">
                Read article
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </a>
            </article>
          ))}
        </div>

        {posts.length === 0 && (
          <div class="text-center py-16">
            <p class="text-slate-600 text-lg">No blog posts yet. Check back soon for technical deep dives and insights!</p>
          </div>
        )}
      </div>
    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 text-slate-400 py-12 text-center">
      <div class="max-w-6xl mx-auto px-6">
        <p class="text-sm">&copy; 2025 Vaibhav Jain. Building the future, one explanation at a time.</p>
      </div>
    </footer>
  </body>
</html>

